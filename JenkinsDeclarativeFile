pipeline{
    agent any
    tools{
        maven "maven3.6.3"
    }
      options{
     timestamps()
} //options
    stages{
        stage('CheckoutStage'){
            steps{
                git branch: 'developement', credentialsId: 'GItHubCredentials', url: 'https://github.com/Alteon-demoapporg/maven-web-application.git'
            }
        }
        stage('Build'){
            steps{
              sh  "mvn clean package"
            }
        }
        stage('ExecuteSonarQubeReport'){
            steps{
                sh "mvn sonar:sonar"
            }
        }
        stage('DeployartifactsIntoNexus'){
            steps{
                sh "mvn deploy"
            }
        }
        stage('DeployAppIntoTomcatServer'){
            steps{
                sshagent(['8334f68d-18b2-46b9-8f8e-8fff2819cd49']) {
                          sh "scp -o StrictHostKeyChecking=no target/maven-web-application.war ec2-user@54.146.61.93:/opt/tomcat/webapps/"
                  }
            }
        }
        
        
    } //stages
    post{
            success{
                emailext body: '''Build Done!!

                    Regards,
                    Pravallika B
                    ''', subject: 'Build Done!!', to: 'bpravalikaraj52@gmail.com'
            } //success
            failure{
            emailext body: '''Build Failure!!

                  Regards,
                  Pravallika B
                  ''', subject: 'Build Done!!', to: 'bpravalikaraj52@gmail.com'
                
                }
            }
        }//pipeline
