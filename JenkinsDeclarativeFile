pipeline{
    agent any
    tools{
        maven "maven3.6.3"
    }
    stages{
        stage('CheckoutStage'){
            steps{
                git branch: 'developement', credentialsId: 'GItHubCredentials', url: 'https://github.com/Alteon-demoapporg/maven-web-application.git'
            }
        }
        stage('Build'){
            steps{
              sh  "mvn clean package"
            }
        }
        stage('ExecuteSonarQubeReport'){
            steps{
                sh "mvn sonar:sonar"
            }
        }
        stage('DeployartifactsIntoNexus'){
            steps{
                sh "mvn deploy"
            }
        }
        stage('DeployAppIntoTomcatServer'){
            steps{
                sshagent(['5b773cc9-beff-4629-b31b-9741a18652b9']) {
                          sh "scp -o StrictHostKeyChecking=no target/maven-web-application.war ec2-user@54.162.82.56:/opt/tomcat/webapps/"
                  }
            }
        }
        
        
    } //stages
    post{
            success{
                emailext body: '''Build Done!!

                    Regards,
                    Pravallika B
                    ''', subject: 'Build Done!!', to: 'bpravalikaraj52@gmail.com'
            } //success
            failure{
            emailext body: '''Build Failure!!

                  Regards,
                  Pravallika B
                  ''', subject: 'Build Done!!', to: 'bpravalikaraj52@gmail.com'
                
                }
            }
        }//pipeline
